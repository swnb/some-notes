# tcp

> 当数据包想要传递的时候，首先通过 IP 和子网掩码来判断是不是在网关里面，如果是在子网里面，那么 arp 查询 mac 地址，发送，不然就发送给网关，网关通过路由表来判断下面传递的方向，替换掉发送包的 mac 地址，如果 nat，那么就要替换 ip。

tcp 和 udp 的不同在 3 点

1. tcp 的链接是可靠的，丢掉的包会重现发送。
2. tcp 的包是有顺序的。
3. tcp 可以控制拥堵，可以调整窗口的大小。

## udp

udp 的包只有源端口和目标的端口，除了这两者，其他就是校验和数据了

udp 一般用于广播和组播，

对于 tcp 而言，由于 tcp 的拥堵控制，丢包的情况下，会自动降低发送的速度，这会导致原本就慢的网络变得更慢，而 udp 不考虑这些。真是因为 tcp 的拥堵控制，在不考虑传输顺序，并且不考虑丢包的实时系统可以考虑 udp.

对于 tcp 包来说，除了源端口和目标端口还有

- 序号和确认序号 序号保证了顺序的传输，确认序号表示包已经收到，如果没有收到那么就继续重新传输。启始序号为了避免混淆，每个链接的起始序号都不该相同。

- 状态位 ，SYN 发起连接，ACK 回复，RST 重新连接，FIN 中断连接

- 窗口大小，标示各自的处理数据的能力

TCP 的 3 次握手和 4 次挥手
